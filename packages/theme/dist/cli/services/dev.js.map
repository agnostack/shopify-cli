{"version":3,"file":"dev.js","sourceRoot":"","sources":["../../../src/cli/services/dev.ts"],"names":[],"mappings":"AAAA,OAAO,EAAC,wBAAwB,EAAE,aAAa,EAAE,aAAa,EAAC,MAAM,0BAA0B,CAAA;AAC/F,OAAO,EAAC,QAAQ,EAAC,MAAM,4BAA4B,CAAA;AACnD,OAAO,EAAC,MAAM,EAAC,MAAM,kBAAkB,CAAA;AAEvC,MAAM,YAAY,GAAG,WAAW,CAAA;AAChC,MAAM,YAAY,GAAG,MAAM,CAAA;AAE3B,MAAM,UAAU,WAAW,CAAC,KAAa,EAAE,OAAe,EAAE,IAAI,GAAG,YAAY,EAAE,IAAI,GAAG,YAAY;IAClG,aAAa,CAAC;QACZ,IAAI,EAAE;YACJ;gBACE,IAAI,EAAE;oBACJ,KAAK,EAAE,EAAC,IAAI,EAAE,oBAAoB,EAAC;oBACnC,KAAK,EAAE;wBACL;4BACE,IAAI,EAAE;gCACJ,GAAG,EAAE,UAAU,IAAI,IAAI,IAAI,EAAE;6BAC9B;yBACF;qBACF;iBACF;aACF;SACF;QACD,SAAS,EAAE;YACT;gBACE;oBACE,IAAI,EAAE;wBACJ,KAAK,EAAE,0CAA0C;wBACjD,GAAG,EAAE,WAAW,KAAK,iBAAiB,OAAO,SAAS;qBACvD;iBACF;aACF;YACD;gBACE;oBACE,IAAI,EAAE;wBACJ,KAAK,EAAE,0BAA0B;wBACjC,GAAG,EAAE,WAAW,KAAK,sBAAsB,OAAO,EAAE;qBACrD;iBACF;aACF;SACF;KACF,CAAC,CAAA;AACJ,CAAC;AAED,MAAM,CAAC,MAAM,gBAAgB,GAAG,CAAC,QAAQ,EAAE,QAAQ,EAAE,UAAU,EAAE,WAAW,CAAC,CAAA;AAE7E,MAAM,UAAU,mBAAmB,CAAC,gBAAwB;IAC1D,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,EAAE;QAC7B,OAAO,CAAC,GAAG,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAC,cAAc,EAAE,EAAE,CAAC,MAAM,CAAC,QAAQ,CAAC,gBAAgB,EAAE,cAAc,CAAC,CAAC,CAAC,CAAC;aACtG,IAAI,CAAC,GAAG,EAAE,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;aACzB,KAAK,CAAC,GAAG,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAA;IAChC,CAAC,CAAC,CAAA;AACJ,CAAC;AAED,MAAM,UAAU,yBAAyB,CAAC,KAAc;IACtD,IAAI,KAAK,EAAE;QACT,OAAO,IAAI,CAAA;KACZ;IAED,aAAa,CAAC,EAAC,IAAI,EAAE,wEAAwE,EAAC,CAAC,CAAA;IAE/F,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,EAAE;QACzB,OAAO,IAAI,CAAA;KACZ;IAED,OAAO,wBAAwB,CAAC;QAC9B,OAAO,EAAE,yBAAyB;KACnC,CAAC,CAAA;AACJ,CAAC;AAED,MAAM,UAAU,uBAAuB,CAAC,IAAc;IACpD,MAAM,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,KAAK,IAAI,CAAC,CAAA;IACxD,MAAM,YAAY,GAAG,UAAU,IAAI,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,UAAU,GAAG,CAAC,CAAC,IAAI,IAAI,CAAC,UAAU,GAAG,CAAC,CAAC,EAAE,UAAU,CAAC,GAAG,CAAC,CAAC,CAAA;IACxG,IAAI,YAAY,EAAE;QAChB,aAAa,CAAC;YACZ,IAAI,EAAE;gBACJ,qEAAqE;gBACrE,EAAC,OAAO,EAAE,qBAAqB,EAAC;gBAChC,EAAC,IAAI,EAAE,GAAG,EAAC;gBACX,cAAc;gBACd,EAAC,OAAO,EAAE,IAAI,EAAC;gBACf,mCAAmC;aACpC;SACF,CAAC,CAAA;KACH;AACH,CAAC","sourcesContent":["import {renderConfirmationPrompt, renderSuccess, renderWarning} from '@shopify/cli-kit/node/ui'\nimport {joinPath} from '@shopify/cli-kit/node/path'\nimport {access} from 'node:fs/promises'\n\nconst DEFAULT_HOST = '127.0.0.1'\nconst DEFAULT_PORT = '9292'\n\nexport function renderLinks(store: string, themeId: string, host = DEFAULT_HOST, port = DEFAULT_PORT) {\n  renderSuccess({\n    body: [\n      {\n        list: {\n          title: {bold: 'Preview your theme'},\n          items: [\n            {\n              link: {\n                url: `http://${host}:${port}`,\n              },\n            },\n          ],\n        },\n      },\n    ],\n    nextSteps: [\n      [\n        {\n          link: {\n            label: 'Customize your theme at the theme editor',\n            url: `https://${store}/admin/themes/${themeId}/editor`,\n          },\n        },\n      ],\n      [\n        {\n          link: {\n            label: 'Share your theme preview',\n            url: `https://${store}/?preview_theme_id=${themeId}`,\n          },\n        },\n      ],\n    ],\n  })\n}\n\nexport const REQUIRED_FOLDERS = ['config', 'layout', 'sections', 'templates']\n\nexport function validThemeDirectory(currentDirectory: string): Promise<boolean> {\n  return new Promise((resolve) => {\n    Promise.all(REQUIRED_FOLDERS.map((requiredFolder) => access(joinPath(currentDirectory, requiredFolder))))\n      .then(() => resolve(true))\n      .catch(() => resolve(false))\n  })\n}\n\nexport function currentDirectoryConfirmed(force: boolean) {\n  if (force) {\n    return true\n  }\n\n  renderWarning({body: 'It doesn’t seem like you’re running this command in a theme directory.'})\n\n  if (!process.stdout.isTTY) {\n    return true\n  }\n\n  return renderConfirmationPrompt({\n    message: 'Do you want to proceed?',\n  })\n}\n\nexport function showDeprecationWarnings(args: string[]) {\n  const eFlagIndex = args.findIndex((arg) => arg === '-e')\n  const wrongEnvFlag = eFlagIndex >= 0 && (!args[eFlagIndex + 1] || args[eFlagIndex + 1]?.startsWith('-'))\n  if (wrongEnvFlag) {\n    renderWarning({\n      body: [\n        'If you want to enable synchronization with Theme Editor, please use',\n        {command: '--theme-editor-sync'},\n        {char: '.'},\n        'The shortcut',\n        {command: '-e'},\n        'is now reserved for environments.',\n      ],\n    })\n  }\n}\n"]}